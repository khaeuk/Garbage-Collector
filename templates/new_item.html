<!DOCTYPE html>
{% load staticfiles %}
<html lang="en">
    <head>
        {% include "header.html" %}

        <title>New Item</title>

        <link   rel="stylesheet" href="{% static "bower_components/bootstrap/dist/css/bootstrap.min.css" %}">

        <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

        <script src="{% static "bower_components/jquery/dist/jquery.min.js" %}"></script>
        <script src="{% static "bower_components/bootstrap/dist/js/bootstrap.min.js" %}"></script>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

        <meta charset=utf-8 />
        <style>
            html, body {
                width:100%;
                height:100%;
                margin:0;
            }

            #editItemContainer {
                margin-top:20px;
                margin-left:15%;
                margin-right:15%;
            }

            #editHeading {
                background-color:#4da5ff;
                color:white;
                font-size:20px;
            }

            #infoContainer {
                margin-left:5%;
                margin-right:5%;
            }

            #editSpotForm {
                margin-bottom:20px;
            }

            #imageContainer {
                display:inline-block;
                width:100%;
                margin-bottom:40px;
            }

            #descriptionFieldContainers textarea {
                vertical-align:top;
            }

            .editLabels {
                text-align: right;
                display:inline-block;
                width:125px;
                margin-right:10px;
            }

            #street_address,
            #city,
            #state,
            #zipcode,
            #default_num_spots,
            /*#cost {
                background-color:white;
                display:inline-block;
                width:200px;
                height:25px;
                padding-left:10px;
                border-style:solid;
                border-width:1px;
                border-color:#4da5ff;
                border-radius:3px;
                margin-top: 20px;

            }*/

            #cost{
                margin-top:20px;
                width:200px;
            }

            #title {
              margin-top: 20px;
              width:200px;
            }


            #condition {
              margin-top: 20px;
              width:200px;
            }

            #state {
                padding-left:7px;
            }

            #description {
                width:400px;
                height:100px;
                padding-left:10px;
                padding-right:10px;
                padding-top:5px;
                border-style:solid;
                border-width:1px;
                border-color:#4da5ff;
                border-radius:3px;
                margin-top: 20px;
            }
            /*#costRestritions{
                font-size: 12px;
                display:none;
            }*/

            #costRestritions{
                color:#A9A9A9;
            }

            #updateButton {
                background-color:#4da5ff;
                color:white;
                width:120px;
                height:40px;
                margin-left:8px;
                border-style:solid;
                border-width:1px;
                border-color:#4da5ff;
                border-radius:5px;
            }

            #cancelButton {
                width:120px;
                height:40px;
                margin-right:8px;
                border-style:solid;
                border-width:1px;
                border-color:lightgrey;
                border-radius:5px;
            }

            #getLocationButton {
                background-color:#4da5ff;
                color:white;
                width:120px;
                height:40px;
                margin-left:8px;
                border-style:solid;
                border-width:1px;
                border-color:#4da5ff;
                border-radius:5px;
            }
            
            #deleteItem {
                background-color:#4da5ff;
                color:white;
                width:120px;
                height:40px;
                margin-left:8px;
                border-style:solid;
                border-width:1px;
                border-color:#4da5ff;
                border-radius:5px;
            }

            tr.alt{
                line-height:20px;
            }

            #itemThumbnail {
                width:300px;
                height:150px;
                margin-bottom:20px;
            }



            #buttons{
              margin-bottom: 20px;

            }
            .hideClass
            {display:none;}

            #costLimit{
               color:#A9A9A9;
            }
            #costLimit:before {
                content: "";
            }

            #cost:focus + #costLimit:before{
                content: "Enter number from 0.00 to 1000";
                margin-left: 5px;
            }
            
            #conditionLimit{
                color:#A9A9A9;
            }
            #conditionLimit:before {
                content: "";
            }

            #condition:focus + #conditionLimit:before{
                content: "Enter integer from 0 to 5, i.e 5 means very good condition ";
                margin-left: 5px;
            }

        </style>


    </head>

    <body>
        <div id="editItemContainer" class="panel panel-default">
            <div id="editHeading" class="panel-heading" align='center'>
                {% if sendfrom == "new" %}   
                    New Item
                {% elif sendfrom == "edit" %}
                    Edit Item
                {% endif %}
                            
            </div>

            <div id="infoContainer">
                <form id="editItemForm" action="." method="POST" enctype="multipart/form-data">



            <!--
            <div class="form-group">
              <label for="description">Description: </label>
              <textarea id="description" class="form-control" name="description" rows="8" cols="80"></textarea>
              <input id="description" class="form-control" type="text" name="description" value="{{form.description.value}}">
            </div> -->
            <!--
            <div style="text-align:right" id="buttondiv">
              <button class="btn btn-primary" type="send" name="send" id="updateButton" value="{{pid}}">Sell</button>
              <button class="btn btn-default" type="button" name="cancel" id="cancelButton" onClick="history.go(-1);">Cancel</button>
            </div>
            -->


                    <div class="fieldContainers">
                        <label  class="editLabels"
                                for="title">Title <span style="color: red">*</span>: </label>
                        <input  id="title"
                                type="text"
                                name="title"
                                placeholder="None"
                                value="{{form.title.value}}"
                                required>   
                                <!---->
                    </div>

                    <div class="fieldContainers">
                        <label  class="editLabels"
                                for="cost">Cost <span style="color: red">*</span>: </label>
                        <input  id="cost"
                                type="number"
                                name="cost"
                                placeholder="0"
                                min="0"
                                max="1000"
                                step="0.01"
                                value="{{form.cost.value}}"
                                required><span id="costLimit"></span>
                                <!---->
                    </div>

                    <div class="fieldContainers">
                        <label  class="editLabels"
                                for="condition">Condition <span style="color: red">*</span>: </label>
                        <input  id="condition"
                                type="number"
                                name="condition"
                                placeholder="0"
                                min="0"
                                max="5"
                                value="{{form.condition.value}}"
                                required><span id="conditionLimit"></span>
                                <!---->
                    </div>

                    <div id="descriptionFieldContainers" class="fieldContainers">
                        <label  class="editLabels"
                                for="description"
                                style="margin-top:60px">Description <span style="color: red">*</span>: </label>
                        {% if form.description.value %}
                            <textarea   id="description"
                                        type="text"
                                        name="description"
                                        style="resize:none"
                                        value = "{{form.description.value}}"
                                        required>{{form.description.value}}</textarea>
                        {% else %}
                            <textarea   id="description"
                                        type="text"
                                        name="description"
                                        placeholder="None"
                                        style="resize:none"
                                        value = "{{form.description.value}}"
                                        required></textarea>
                        {% endif %}
                    </div>

                    <hr>
                    <div id="imageContainer">
                      <label class="editLabels" for="photoButton">
                      <i class="glyphicon glyphicon-camera"></i> Image<span style="color: red">*</span>: </label>

                     <img src="{{instance.photos.url}}" alt="Image" id="thumbnail" width="100px" height="auto">
                     <hr>
                        {% if form.photos.value %}
                        <input  type="file"
                                id="photoButton"
                                accept="image/*"
                                name="photos"
                                onchange="readURL(this)"
                                />
                        
                        {% else %} 
                        <input  type="file"
                            id="photoButton"
                            accept="image/*"
                            name="photos"
                            onchange="readURL(this)"
                            required
                            />
                        {% endif %}
                    </div>

                    <div id="divSample" class="hideClass">Latitude:
                         <input type="text" id="Latitude" name="Latitude" value="">
                         <br>
                         <br>Longitude:
                         <input type="text" id="Longitude" name="Longitude" value="">
                         <br>
                    </div>

                    <div id="buttons">
                    <button name="cancel"
                            type="button"
                            id="cancelButton"
                            onClick="history.go(-1)">Cancel</button>

                    {% if sendfrom == "new" %}
                        <input type="button" id="getLocationButton" value="Get Location" onclick="getLocationConstant()" />
                    {% elif sendfrom == "edit" %}
                        <input type="button" id="deleteItem" value="delete" onclick="" />
                    {% endif %}

                    <button name="send"
                            type="submit"
                            id="updateButton"
                            formaction = "."
                            value="{{pid}}">Confirm</button>
                    </div>
                    {% csrf_token %}
                </form>
            </div>
        </div>
    </body>

    <script type="text/javascript">
        function getLocationConstant() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(onGeoSuccess, onGeoError);
            } else {
                alert("Your browser or device doesn't support Geolocation");
            }
        }

        // If we have a successful location update
        function onGeoSuccess(event) {
            document.getElementById("Latitude").value = event.coords.latitude;
            document.getElementById("Longitude").value = event.coords.longitude;

        }

        function onGeoError(event) {
            alert("Error code " + event.code + ". " + event.message);
        }
        
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#thumbnail')
                        .attr('src', e.target.result)
                        .width(150)
                        .height(200);
                };

                reader.readAsDataURL(input.files[0]);
            }
        }

    </script>

</html>
